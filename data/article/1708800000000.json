{
  "id": "1708800000000",
  "title": "[26.02.23] Dog Lameness Detection - Unsupervised 5단계",
  "content": "<h1>비지도 학습으로 강아지 보행 패턴을 탐색할 수 있을까?</h1><p style=\"color:#6b7280; font-size:0.95em;\">Transformer Autoencoder를 활용한 비지도(Unsupervised) 실험 시리즈의 결과를 정리합니다.<br/>총 5단계 실험으로 구성되며, 단계마다 기법을 추가하거나 변경하여 효과를 검증합니다.</p><hr/><h2>먼저 알아두면 좋은 배경 지식</h2><p>이전 실험에서는 <strong>\"이 강아지는 정상 / 왼쪽 뒷다리 이상 / 오른쪽 뒷다리 이상\"</strong>처럼 <strong>정답 라벨을 알려주고</strong> 모델에게 분류를 학습시켰습니다 (지도 학습). 이번에는 전혀 다른 접근을 시도합니다.</p><h3>비지도 학습이란?</h3><p>비지도 학습은 <strong>정답을 알려주지 않고</strong>, 데이터 자체에서 숨겨진 패턴이나 구조를 찾아내는 방법입니다. 마치 시험 정답지 없이 문제의 유형을 스스로 분류해보는 것과 비슷합니다.</p><h3>Autoencoder(오토인코더)란?</h3><p>오토인코더는 <strong>\"압축 후 복원\"</strong> 방식으로 작동합니다.</p><ol><li><strong>인코더(Encoder):</strong> 입력 데이터를 아주 작은 크기로 <strong>압축</strong>합니다. 긴 문장을 핵심 키워드 몇 개로 요약하는 것과 같습니다.</li><li><strong>잠재 공간(Latent Space):</strong> 압축된 요약이 저장되는 공간입니다. 여기에 데이터의 <strong>핵심 특징</strong>만 남습니다.</li><li><strong>디코더(Decoder):</strong> 압축된 요약으로부터 원래 데이터를 <strong>복원</strong>합니다.</li></ol><p>잘 학습된 오토인코더라면, 압축된 공간에서 <strong>비슷한 보행 패턴은 가까이, 다른 패턴은 멀리</strong> 위치하게 됩니다.</p><h3>왜 Transformer인가?</h3><p>보행 데이터는 <strong>시간 순서대로 나열된 관절 좌표</strong>입니다. Transformer는 시계열 데이터에서 <strong>먼 프레임 간의 관계</strong>도 잘 파악하여, 걸음걸이의 미묘한 리듬이나 패턴을 잡아내는 데 적합합니다.</p><h3>이 보고서에서 사용하는 평가 지표 안내</h3><p style=\"background:#f0f9ff; padding:12px; border-radius:8px;\">각 실험의 결과를 비교하기 위해 여러 수치를 사용합니다. 간단히 설명하면:</p><ul><li><strong>Linear Probe bACC</strong> — 압축된 특징으로 간단한 분류기를 돌린 정확도. 높을수록 질병 구분에 유용한 정보가 담겨있다는 뜻 (랜덤=33%)</li><li><strong>kNN Probe bACC</strong> — 가까운 이웃끼리 같은 라벨인지 확인. 비슷한 보행끼리 모여있는 정도</li><li><strong>Silhouette</strong> — 클러스터가 얼마나 뚜렷하게 나뉘는지 (1에 가까울수록 좋음)</li><li><strong>ARI / NMI</strong> — 자동 그룹핑과 실제 라벨의 일치도 (1에 가까울수록 좋음, 0이면 무관)</li><li><strong>dog_id 예측력</strong> — 압축 공간에서 \"어떤 강아지인지\"를 얼마나 맞추는지. <strong>높으면 오히려 문제</strong> (개체 편향)</li></ul><hr/><h2>실험 로드맵: 5단계 실험</h2><p>각 단계마다 기법을 추가하거나 변경하여, <strong>어떤 기법이 효과가 있고 없는지</strong>를 하나씩 검증합니다.</p><table style=\"border-collapse:collapse; width:100%; margin:16px 0; font-size:0.92em;\"><thead><tr style=\"background:#f3f4f6;\"><th style=\"border:1px solid #d1d5db; padding:8px;\">단계</th><th style=\"border:1px solid #d1d5db; padding:8px;\">실험명</th><th style=\"border:1px solid #d1d5db; padding:8px;\">정규화</th><th style=\"border:1px solid #d1d5db; padding:8px;\">좌우반전</th><th style=\"border:1px solid #d1d5db; padding:8px;\">대조학습</th><th style=\"border:1px solid #d1d5db; padding:8px;\">핵심 질문</th></tr></thead><tbody><tr style=\"background:#d1fae5;\"><td style=\"border:1px solid #d1d5db; padding:8px;\">01</td><td style=\"border:1px solid #d1d5db; padding:8px;\"><strong>Baseline</strong></td><td style=\"border:1px solid #d1d5db; padding:8px;\">X</td><td style=\"border:1px solid #d1d5db; padding:8px;\">X</td><td style=\"border:1px solid #d1d5db; padding:8px;\">X</td><td style=\"border:1px solid #d1d5db; padding:8px;\">기본 AE가 질병 패턴을 잡는가?</td></tr><tr style=\"background:#dbeafe;\"><td style=\"border:1px solid #d1d5db; padding:8px;\">02</td><td style=\"border:1px solid #d1d5db; padding:8px;\"><strong>+ Norm</strong></td><td style=\"border:1px solid #d1d5db; padding:8px;\">O</td><td style=\"border:1px solid #d1d5db; padding:8px;\">X</td><td style=\"border:1px solid #d1d5db; padding:8px;\">X</td><td style=\"border:1px solid #d1d5db; padding:8px;\">체형 차이를 제거하면 질병 신호가 더 뚜렷한가?</td></tr><tr style=\"background:#fef3c7;\"><td style=\"border:1px solid #d1d5db; padding:8px;\">03</td><td style=\"border:1px solid #d1d5db; padding:8px;\"><strong>+ Norm + Flip</strong></td><td style=\"border:1px solid #d1d5db; padding:8px;\">O</td><td style=\"border:1px solid #d1d5db; padding:8px;\">O</td><td style=\"border:1px solid #d1d5db; padding:8px;\">X</td><td style=\"border:1px solid #d1d5db; padding:8px;\">좌우 반전으로 데이터를 늘리면 개선되는가?</td></tr><tr style=\"background:#fce7f3;\"><td style=\"border:1px solid #d1d5db; padding:8px;\">04</td><td style=\"border:1px solid #d1d5db; padding:8px;\"><strong>Flip + Contrastive</strong></td><td style=\"border:1px solid #d1d5db; padding:8px;\">X</td><td style=\"border:1px solid #d1d5db; padding:8px;\">O (쌍 생성)</td><td style=\"border:1px solid #d1d5db; padding:8px;\">O (NT-Xent)</td><td style=\"border:1px solid #d1d5db; padding:8px;\">대조 학습이 의미 있는 구조를 만드는가?</td></tr><tr style=\"background:#ede9fe;\"><td style=\"border:1px solid #d1d5db; padding:8px;\">05</td><td style=\"border:1px solid #d1d5db; padding:8px;\"><strong>Contrastive Only</strong></td><td style=\"border:1px solid #d1d5db; padding:8px;\">X</td><td style=\"border:1px solid #d1d5db; padding:8px;\">X</td><td style=\"border:1px solid #d1d5db; padding:8px;\">O (노이즈 쌍)</td><td style=\"border:1px solid #d1d5db; padding:8px;\">Flip 없이 노이즈만으로 대조학습이 가능한가?</td></tr></tbody></table><p>모든 단계는 <strong>FR/HI (앞다리/뒷다리 이상)</strong>과 <strong>HL/HR (뒷다리 좌/우 이상)</strong> 두 가지 데이터 구성으로 각각 실험합니다.</p><hr/><h2 style=\"background:#d1fae5; padding:12px; border-radius:8px;\">01. Baseline — 순수 오토인코더</h2><p style=\"background:#f0fdf4; padding:12px; border-radius:8px;\"><strong>추가 기법:</strong> 없음. 순수 Transformer Autoencoder만 사용.<br/><strong>핵심 질문:</strong> 아무 처리 없이 오토인코더만으로 질병 패턴을 잡을 수 있는가?</p><h3>학습 곡선</h3><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">FR/HI</p><img src=\"/api/assets/unsup_frhi_cell9_img1.png\" alt=\"Training Loss\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">HL/HR</p><img src=\"/api/assets/unsup_hlhr_cell9_img1.png\" alt=\"Training Loss\" style=\"max-width:100%; margin:8px 0;\"/></div></div><h3>t-SNE 시각화: 압축 공간에서 질병별로 나뉘는가?</h3><p>t-SNE로 고차원 데이터를 2D 지도로 그려봅니다. 같은 색끼리 모여있으면 질병 구분이 잘 되는 것입니다.</p><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">FR/HI</p><img src=\"/api/assets/unsup_frhi_cell11_img2.png\" alt=\"t-SNE\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">HL/HR</p><img src=\"/api/assets/unsup_hlhr_cell11_img2.png\" alt=\"t-SNE\" style=\"max-width:100%; margin:8px 0;\"/></div></div><h3>정량 평가</h3><table style=\"border-collapse:collapse; width:100%; margin:16px 0;\"><thead><tr style=\"background:#f3f4f6;\"><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">지표</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">FR/HI</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">HL/HR</th></tr></thead><tbody><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">Linear Probe bACC</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">52.1%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\"><strong>59.2%</strong></td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">kNN Probe bACC</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">49.8%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">51.0%</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">Silhouette</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.138</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.116</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">ARI</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.011</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.022</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">dog_id 예측력</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">38.9%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">32.3%</td></tr></tbody></table><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">Linear Probe 혼동행렬 (FR/HI)</p><img src=\"/api/assets/unsup_frhi_cell15_img4.png\" alt=\"CM\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">Linear Probe 혼동행렬 (HL/HR)</p><img src=\"/api/assets/unsup_hlhr_cell15_img4.png\" alt=\"CM\" style=\"max-width:100%; margin:8px 0;\"/></div></div><p style=\"background:#fef3c7; padding:12px; border-radius:8px;\"><strong>01 Baseline 결론:</strong> 오토인코더가 보행 패턴은 잘 학습했지만(Loss 97% 감소), 압축 공간이 질병 라벨과 잘 대응하지 않음(ARI≈0.01~0.02). 특히 <strong>\"어떤 강아지인지\"(개체 ID)가 압축 공간에 강하게 반영</strong>되어 있어(38.9%), 개체 편향이 주요 혼란 요인으로 확인됨.</p><hr/><h2 style=\"background:#dbeafe; padding:12px; border-radius:8px;\">02. + Per-Sample Normalization — 체형 차이 제거</h2><p style=\"background:#eff6ff; padding:12px; border-radius:8px;\"><strong>추가 기법:</strong> 각 보행 구간에서 평균 자세를 빼서, 개체별 체형 차이(키, 다리 길이)를 제거<br/><strong>핵심 질문:</strong> 개체 정보를 지우면 질병 신호가 더 잘 드러나는가?</p><p>비유하자면, 모든 강아지의 키와 체형을 동일하게 맞춘 뒤 걸음걸이만 비교하는 것입니다.</p><h3>학습 곡선</h3><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">FR/HI</p><img src=\"/api/assets/02_norm_normal_fr_hi_img1.png\" alt=\"Training Loss\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">HL/HR</p><img src=\"/api/assets/02_norm_normal_hl_hr_img1.png\" alt=\"Training Loss\" style=\"max-width:100%; margin:8px 0;\"/></div></div><h3>t-SNE 시각화</h3><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">FR/HI</p><img src=\"/api/assets/02_norm_normal_fr_hi_img2.png\" alt=\"t-SNE\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">HL/HR</p><img src=\"/api/assets/02_norm_normal_hl_hr_img2.png\" alt=\"t-SNE\" style=\"max-width:100%; margin:8px 0;\"/></div></div><h3>정량 평가</h3><table style=\"border-collapse:collapse; width:100%; margin:16px 0;\"><thead><tr style=\"background:#f3f4f6;\"><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">지표</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">FR/HI</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">HL/HR</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">vs 01</th></tr></thead><tbody><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">Linear Probe bACC</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">42.4%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">47.1%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">▼ 하락</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">kNN Probe bACC</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">45.4%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">43.9%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">▼ 하락</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">Silhouette</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.054</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.055</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">▼ 절반 이하</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">ARI</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.003</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.001</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">▼ 하락</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">dog_id 예측력</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#16a34a;\">14.8%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#16a34a;\">13.6%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#16a34a;\">▼ 대폭 감소 (좋음!)</td></tr></tbody></table><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">Linear Probe 혼동행렬 (FR/HI)</p><img src=\"/api/assets/02_norm_normal_fr_hi_img4.png\" alt=\"CM\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">Linear Probe 혼동행렬 (HL/HR)</p><img src=\"/api/assets/02_norm_normal_hl_hr_img4.png\" alt=\"CM\" style=\"max-width:100%; margin:8px 0;\"/></div></div><p style=\"background:#fef3c7; padding:12px; border-radius:8px;\"><strong>02 Normalization 결론:</strong> 개체 편향 제거에는 성공(dog_id 38.9%→14.8%)했지만, <strong>질병 분류 성능도 함께 하락</strong>(bACC 52.1%→42.4%). 이 데이터에서 질병 신호가 개체 정보(체형/크기)와 강하게 얽혀 있어, 하나를 제거하면 다른 것도 사라지는 문제가 확인됨.</p><hr/><h2 style=\"background:#fef3c7; padding:12px; border-radius:8px;\">03. + Norm + LR Flip — 좌우 반전으로 데이터 증강</h2><p style=\"background:#fffbeb; padding:12px; border-radius:8px;\"><strong>추가 기법:</strong> 02의 정규화에 더해, 좌우 반전으로 데이터를 2배로 증강<br/><strong>핵심 질문:</strong> 데이터를 늘리면 정규화로 잃은 신호를 보완할 수 있는가?</p><p>강아지를 거울에 비추듯 좌우를 뒤집어 데이터를 2배로 만듭니다. HL/HR 모드에서는 뒷다리 좌/우 라벨도 함께 바뀝니다.</p><h3>학습 곡선</h3><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">FR/HI (3,798개 윈도우)</p><img src=\"/api/assets/03_flip_normal_fr_hi_img1.png\" alt=\"Training Loss\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">HL/HR (3,260개 윈도우)</p><img src=\"/api/assets/03_flip_normal_hl_hr_img1.png\" alt=\"Training Loss\" style=\"max-width:100%; margin:8px 0;\"/></div></div><h3>t-SNE 시각화</h3><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">FR/HI</p><img src=\"/api/assets/03_flip_normal_fr_hi_img2.png\" alt=\"t-SNE\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">HL/HR</p><img src=\"/api/assets/03_flip_normal_hl_hr_img2.png\" alt=\"t-SNE\" style=\"max-width:100%; margin:8px 0;\"/></div></div><h3>정량 평가</h3><table style=\"border-collapse:collapse; width:100%; margin:16px 0;\"><thead><tr style=\"background:#f3f4f6;\"><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">지표</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">FR/HI</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">HL/HR</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">vs 02</th></tr></thead><tbody><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">Linear Probe bACC</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">51.9%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">54.3%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#16a34a;\">▲ 회복</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">kNN Probe bACC</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\"><strong>53.4%</strong></td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">50.0%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#16a34a;\">▲ 회복</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">Silhouette</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.116</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.117</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#16a34a;\">▲ 회복</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">ARI</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.000</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.004</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">→ 변화 없음</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">dog_id 예측력</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">41.1%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">38.7%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">▲ 다시 상승 (나쁨!)</td></tr></tbody></table><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">Linear Probe 혼동행렬 (FR/HI)</p><img src=\"/api/assets/03_flip_normal_fr_hi_img4.png\" alt=\"CM\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">Linear Probe 혼동행렬 (HL/HR)</p><img src=\"/api/assets/03_flip_normal_hl_hr_img4.png\" alt=\"CM\" style=\"max-width:100%; margin:8px 0;\"/></div></div><p style=\"background:#fef3c7; padding:12px; border-radius:8px;\"><strong>03 Norm+Flip 결론:</strong> 좌우 반전으로 데이터를 2배 늘리니 분류 성능은 02보다 회복됨. 그러나 <strong>개체 편향이 baseline 수준으로 되돌아옴</strong>(dog_id 41.1%). 같은 강아지의 데이터를 단순 복제한 효과여서, 정규화의 deconfounding 효과가 상쇄됨.</p><hr/><h2 style=\"background:#fce7f3; padding:12px; border-radius:8px;\">04. Flip + Contrastive — 대조 학습 도입</h2><p style=\"background:#fdf2f8; padding:12px; border-radius:8px;\"><strong>변경:</strong> 정규화를 제거하고, 좌우 반전 + NT-Xent 대조 학습을 추가<br/><strong>핵심 질문:</strong> \"원본과 반전은 같은 보행\"이라고 가르치면, 더 의미 있는 표현을 학습하는가?</p><p><strong>대조 학습(Contrastive Learning)</strong>은 같은 사람의 다른 각도 사진을 \"같다\"고 인식하도록 학습하는 방법입니다. 여기서는 원본 보행과 좌우 반전 보행을 \"같은 쌍\"으로, 다른 샘플은 \"다른 쌍\"으로 설정합니다.</p><p><strong>Loss = 복원 Loss + 0.5 × 대조 Loss (NT-Xent)</strong></p><h3>학습 곡선</h3><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">FR/HI</p><img src=\"/api/assets/04_contrastive_normal_fr_hi_img1.png\" alt=\"Training Loss\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">HL/HR</p><img src=\"/api/assets/04_contrastive_normal_hl_hr_img1.png\" alt=\"Training Loss\" style=\"max-width:100%; margin:8px 0;\"/></div></div><p style=\"background:#fff1f2; padding:12px; border-radius:8px;\"><strong>주목:</strong> HL/HR에서 대조 학습 수렴이 매우 느림 (epoch 50에서 contrastive loss가 여전히 1.82). FR/HI는 빠르게 수렴. 학습 안정성에 차이가 있음.</p><h3>t-SNE 시각화</h3><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">FR/HI</p><img src=\"/api/assets/04_contrastive_normal_fr_hi_img2.png\" alt=\"t-SNE\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">HL/HR</p><img src=\"/api/assets/04_contrastive_normal_hl_hr_img2.png\" alt=\"t-SNE\" style=\"max-width:100%; margin:8px 0;\"/></div></div><h3>정량 평가</h3><table style=\"border-collapse:collapse; width:100%; margin:16px 0;\"><thead><tr style=\"background:#f3f4f6;\"><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">지표</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">FR/HI</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">HL/HR</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">vs 01</th></tr></thead><tbody><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">Linear Probe bACC</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">44.4%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">47.2%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">▼ 하락</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">kNN Probe bACC</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">41.9%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">42.8%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">▼ 하락</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">Silhouette</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.059</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.080</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">▼ 하락</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">ARI</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.004</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.007</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#dc2626;\">▼ 하락</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">dog_id 예측력</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#16a34a;\"><strong>11.2%</strong></td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#16a34a;\"><strong>12.7%</strong></td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#16a34a;\">▼ 최저! (좋음)</td></tr></tbody></table><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">Linear Probe 혼동행렬 (FR/HI)</p><img src=\"/api/assets/04_contrastive_normal_fr_hi_img4.png\" alt=\"CM\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">Linear Probe 혼동행렬 (HL/HR)</p><img src=\"/api/assets/04_contrastive_normal_hl_hr_img4.png\" alt=\"CM\" style=\"max-width:100%; margin:8px 0;\"/></div></div><p style=\"background:#fef3c7; padding:12px; border-radius:8px;\"><strong>04 Flip+Contrastive 결론:</strong> 대조 학습이 <strong>개체 편향 제거에 가장 효과적</strong>(dog_id 11.2%, 5단계 중 최저). \"원본과 반전은 같다\"는 학습이 개체 고유 정보보다 <strong>변환 불변(invariant) 특성</strong>을 학습하게 만듦. 그러나 질병 분류 성능도 함께 하락하여, 개체 정보와 질병 신호가 분리되지 않는 근본 문제는 여전.</p><hr/><h2 style=\"background:#ede9fe; padding:12px; border-radius:8px;\">05. Contrastive Only — 노이즈 기반 대조 학습</h2><p style=\"background:#f5f3ff; padding:12px; border-radius:8px;\"><strong>변경:</strong> 좌우 반전 대신 <strong>가우시안 노이즈</strong>로 positive pair를 생성<br/><strong>핵심 질문:</strong> Flip 없이 노이즈만으로도 대조학습이 유사한 효과를 내는가?</p><p>04에서는 좌우 반전이 대조 학습의 \"같은 쌍\"을 만드는 역할을 했습니다. 05에서는 이를 <strong>미세한 랜덤 노이즈 추가</strong>로 대체합니다. \"살짝 흔들어도 같은 보행\"이라고 학습하는 방식입니다.</p><h3>학습 곡선</h3><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">FR/HI</p><img src=\"/api/assets/05_contrastive_only_normal_fr_hi_img1.png\" alt=\"Training Loss\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">HL/HR</p><img src=\"/api/assets/05_contrastive_only_normal_hl_hr_img1.png\" alt=\"Training Loss\" style=\"max-width:100%; margin:8px 0;\"/></div></div><h3>t-SNE 시각화</h3><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">FR/HI</p><img src=\"/api/assets/05_contrastive_only_normal_fr_hi_img2.png\" alt=\"t-SNE\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">HL/HR</p><img src=\"/api/assets/05_contrastive_only_normal_hl_hr_img2.png\" alt=\"t-SNE\" style=\"max-width:100%; margin:8px 0;\"/></div></div><h3>정량 평가</h3><table style=\"border-collapse:collapse; width:100%; margin:16px 0;\"><thead><tr style=\"background:#f3f4f6;\"><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">지표</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">FR/HI</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">HL/HR</th><th style=\"border:1px solid #d1d5db; padding:8px 12px;\">vs 04</th></tr></thead><tbody><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">Linear Probe bACC</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">45.6%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">46.1%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">→ 유사</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">kNN Probe bACC</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">41.3%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\"><strong>49.5%</strong></td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">→ HL/HR에서 소폭 상승</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">Silhouette</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.057</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.063</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">→ 유사</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">ARI</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">0.005</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\"><strong>0.009</strong></td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#16a34a;\">→ 소폭 상승</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">dog_id 예측력</td><td style=\"border:1px solid #d1d5db; padding:8px 12px; color:#16a34a;\">11.2%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">20.4%</td><td style=\"border:1px solid #d1d5db; padding:8px 12px;\">FR/HI 동일, HL/HR 소폭 상승</td></tr></tbody></table><div style=\"display:flex; gap:16px; flex-wrap:wrap;\"><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">Linear Probe 혼동행렬 (FR/HI)</p><img src=\"/api/assets/05_contrastive_only_normal_fr_hi_img4.png\" alt=\"CM\" style=\"max-width:100%; margin:8px 0;\"/></div><div style=\"flex:1; min-width:280px;\"><p style=\"text-align:center; font-weight:bold;\">Linear Probe 혼동행렬 (HL/HR)</p><img src=\"/api/assets/05_contrastive_only_normal_hl_hr_img4.png\" alt=\"CM\" style=\"max-width:100%; margin:8px 0;\"/></div></div><p style=\"background:#fef3c7; padding:12px; border-radius:8px;\"><strong>05 Contrastive Only 결론:</strong> Flip 없이 노이즈만으로도 04와 거의 동일한 결과. <strong>대조 학습의 효과는 augmentation 종류(flip vs noise)보다는 대조 학습 자체의 메커니즘에서 비롯됨</strong>을 확인. HL/HR에서 dog_id가 소폭 상승(20.4%)한 것은, flip이 좌우 대칭 정보를 강제하여 개체 정보를 더 효과적으로 지운다는 것을 시사.</p><hr/><h2>전체 비교: 5단계 실험 한눈에 보기</h2><h3>FR/HI (정상 / 앞다리 이상 / 뒷다리 이상)</h3><table style=\"border-collapse:collapse; width:100%; margin:16px 0; font-size:0.88em;\"><thead><tr style=\"background:#f3f4f6;\"><th style=\"border:1px solid #d1d5db; padding:6px 8px;\">지표</th><th style=\"border:1px solid #d1d5db; padding:6px 8px; background:#d1fae5;\">01 Base</th><th style=\"border:1px solid #d1d5db; padding:6px 8px; background:#dbeafe;\">02 Norm</th><th style=\"border:1px solid #d1d5db; padding:6px 8px; background:#fef3c7;\">03 N+Flip</th><th style=\"border:1px solid #d1d5db; padding:6px 8px; background:#fce7f3;\">04 F+Contr</th><th style=\"border:1px solid #d1d5db; padding:6px 8px; background:#ede9fe;\">05 C.Only</th></tr></thead><tbody><tr><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">데이터 수</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">1,899</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">1,899</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">3,798</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">1,899</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">1,899</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:6px 8px;\"><strong>Linear bACC</strong></td><td style=\"border:1px solid #d1d5db; padding:6px 8px; font-weight:bold; color:#16a34a;\">52.1%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">42.4%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">51.9%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">44.4%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">45.6%</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:6px 8px;\"><strong>kNN bACC</strong></td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">49.8%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">45.4%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px; font-weight:bold; color:#16a34a;\">53.4%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">41.9%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">41.3%</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">Silhouette</td><td style=\"border:1px solid #d1d5db; padding:6px 8px; font-weight:bold; color:#16a34a;\">0.138</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.054</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.116</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.059</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.057</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">ARI</td><td style=\"border:1px solid #d1d5db; padding:6px 8px; font-weight:bold; color:#16a34a;\">0.011</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.003</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.000</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.004</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.005</td></tr><tr style=\"background:#fff1f2;\"><td style=\"border:1px solid #d1d5db; padding:6px 8px;\"><strong>dog_id 예측력</strong></td><td style=\"border:1px solid #d1d5db; padding:6px 8px; color:#dc2626;\">38.9%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">14.8%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px; color:#dc2626;\">41.1%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px; font-weight:bold; color:#16a34a;\">11.2%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px; font-weight:bold; color:#16a34a;\">11.2%</td></tr></tbody></table><h3>HL/HR (정상 / 뒷다리 왼쪽 / 뒷다리 오른쪽)</h3><table style=\"border-collapse:collapse; width:100%; margin:16px 0; font-size:0.88em;\"><thead><tr style=\"background:#f3f4f6;\"><th style=\"border:1px solid #d1d5db; padding:6px 8px;\">지표</th><th style=\"border:1px solid #d1d5db; padding:6px 8px; background:#d1fae5;\">01 Base</th><th style=\"border:1px solid #d1d5db; padding:6px 8px; background:#dbeafe;\">02 Norm</th><th style=\"border:1px solid #d1d5db; padding:6px 8px; background:#fef3c7;\">03 N+Flip</th><th style=\"border:1px solid #d1d5db; padding:6px 8px; background:#fce7f3;\">04 F+Contr</th><th style=\"border:1px solid #d1d5db; padding:6px 8px; background:#ede9fe;\">05 C.Only</th></tr></thead><tbody><tr><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">데이터 수</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">1,630</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">1,630</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">3,260</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">1,630</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">1,630</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:6px 8px;\"><strong>Linear bACC</strong></td><td style=\"border:1px solid #d1d5db; padding:6px 8px; font-weight:bold; color:#16a34a;\">59.2%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">47.1%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">54.3%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">47.2%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">46.1%</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:6px 8px;\"><strong>kNN bACC</strong></td><td style=\"border:1px solid #d1d5db; padding:6px 8px; font-weight:bold; color:#16a34a;\">51.0%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">43.9%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">50.0%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">42.8%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">49.5%</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">Silhouette</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.116</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.055</td><td style=\"border:1px solid #d1d5db; padding:6px 8px; font-weight:bold; color:#16a34a;\">0.117</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.080</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.063</td></tr><tr><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">ARI</td><td style=\"border:1px solid #d1d5db; padding:6px 8px; font-weight:bold; color:#16a34a;\">0.022</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.001</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.004</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.007</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">0.009</td></tr><tr style=\"background:#fff1f2;\"><td style=\"border:1px solid #d1d5db; padding:6px 8px;\"><strong>dog_id 예측력</strong></td><td style=\"border:1px solid #d1d5db; padding:6px 8px; color:#dc2626;\">32.3%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">13.6%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px; color:#dc2626;\">38.7%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px; font-weight:bold; color:#16a34a;\">12.7%</td><td style=\"border:1px solid #d1d5db; padding:6px 8px;\">20.4%</td></tr></tbody></table><hr/><h2>핵심 발견과 시사점</h2><div style=\"background:#f0fdf4; padding:16px; border-radius:8px; margin:16px 0;\"><h3 style=\"margin-top:0;\">1. 질병 신호와 개체 정보가 강하게 얽혀 있다</h3><p>5단계 실험의 가장 중요한 발견입니다. 개체 편향(dog_id)을 줄이면 질병 분류도 떨어지고, 질병 분류가 높으면 개체 편향도 높습니다. 이는 <strong>현재 데이터에서 \"어떤 강아지인지\"와 \"어떤 질병인지\"가 통계적으로 분리하기 어렵다</strong>는 것을 의미합니다.</p></div><div style=\"background:#eff6ff; padding:16px; border-radius:8px; margin:16px 0;\"><h3 style=\"margin-top:0;\">2. 대조 학습이 개체 편향 제거에 가장 효과적</h3><p>04(Flip+Contrastive)와 05(Noise+Contrastive) 모두 dog_id 예측력을 11~20%대로 낮추는 데 성공했습니다. 특히 04의 FR/HI에서 <strong>11.2%</strong>로 5단계 중 최저치를 기록. 대조 학습은 augmentation 종류와 무관하게 <strong>변환 불변 특성</strong>을 학습시키는 효과가 있습니다.</p></div><div style=\"background:#fefce8; padding:16px; border-radius:8px; margin:16px 0;\"><h3 style=\"margin-top:0;\">3. 좌우 반전(Flip)은 양날의 검</h3><p>03에서 flip은 데이터를 2배로 늘리고 분류 성능을 회복시켰지만, <strong>같은 개체의 데이터가 복제</strong>되면서 개체 편향이 되살아났습니다(41.1%). 반면, 04에서 flip을 대조 학습의 positive pair로 사용했을 때는 오히려 개체 편향을 효과적으로 제거했습니다. <strong>같은 기법이라도 사용 방식에 따라 정반대의 효과</strong>를 낼 수 있습니다.</p></div><div style=\"background:#fdf2f8; padding:16px; border-radius:8px; margin:16px 0;\"><h3 style=\"margin-top:0;\">4. 순수 비지도 학습의 한계</h3><p>5단계 모든 실험에서 K-Means ARI가 0.02 이하로, 잠재 공간이 질병 라벨 기준으로 자연스럽게 나뉘지 않았습니다. 비지도 오토인코더는 \"복원에 필요한 정보\"를 학습하지, \"질병 구분에 필요한 정보\"를 우선적으로 학습하지는 않기 때문입니다.</p></div><div style=\"background:#f5f3ff; padding:16px; border-radius:8px; margin:16px 0;\"><h3 style=\"margin-top:0;\">5. 다음 방향 제안</h3><ul><li><strong>입력 표현 변경:</strong> 절대 좌표 대신 관절 간 각도나 상대 좌표를 사용하면 개체 크기 영향을 구조적으로 제거 가능</li><li><strong>Semi-supervised 접근:</strong> 소량의 라벨 정보를 활용하여 잠재 공간을 유도</li><li><strong>다른 augmentation 탐색:</strong> temporal jittering, random masking, speed perturbation 등</li><li><strong>Reconstruction-free 접근:</strong> 복원 없이 순수 대조 학습만으로 학습</li></ul></div><hr/><p style=\"color:#6b7280; font-size:0.9em;\">작성일: 2026-02-23 | Transformer Autoencoder (d_model=128, latent=64, 3 layers) | 200 epochs | CUDA<br/>실험 노트북: unsupervised/01_baseline ~ 05_contrastive_only (x2 FR-HI / HL-HR, 총 10개)</p>",
  "date": "2026-02-23T01:00:00.000Z"
}